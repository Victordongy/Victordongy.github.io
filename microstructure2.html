
<!DOCTYPE HTML>
<!--
	Dopetrope 2.0 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
			<title>Victor's Blog</title>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<meta charset="utf-8" />
			<link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Victor's Blog Full Atom Feed" />
			<link href="/feeds/posts.atom.xml" type="application/atom+xml" rel="alternate" title="Victor's Blog Categories Atom Feed" />
			<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,900,300italic" rel="stylesheet" />
				<link rel="stylesheet" href="/theme/css/pygment.css" />
			<noscript>
				<link rel="stylesheet" href="/theme/css/skel-noscript.css" />
				<link rel="stylesheet" href="/theme/css/style.css" />
				<link rel="stylesheet" href="/theme/css/style-desktop.css" />
			</noscript>
	</head>
	<body class="no-sidebar">
		<!-- Header Wrapper -->
			<div id="header-wrapper">
				<div class="container">
					<div class="row">
						<div class="12u">
						
							<!-- Header -->
								<section id="header">
									
									<!-- Logo -->
									<h1><a href="/">Victor's Blog</a></h1>
									
									<!-- Nav -->
										<nav id="nav">
											<ul>
														<li><a href="/pages/Third-Post.html">CV</a></li>
											</ul>
										</nav>

								</section>

						</div>
					</div>
				</div>
			</div>
		
		<!-- Main Wrapper -->
			<div id="main-wrapper">
				<div class="container">
<div class="row">
	<div class="12u">
			<section>
				<div>
					<div class="row">
						<div class="12u skel-cell-mainContent">
							<!-- Content -->
								<article class="box is-post">
									<div class="post-infos">
										<ul class="tags">
											<li><a class="button" href="category/posts.html">Posts</a></li>
												<li><a class="button button-alt" href="tag/microstructure.html">Microstructure</a></li>

										</ul>
									</div>

									<div class="pennant pennant-alt date">2017-12-01</div>
									<h2>Stochastic Process</h2>
									<style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Thoughts-on-Stochastic-Process">Thoughts on Stochastic Process<a class="anchor-link" href="#Thoughts-on-Stochastic-Process">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We remember from the basic theory the stochastic process</p>
<ul>
<li>For any $0 \leq s < t$, the random variable $B_t - B_s$ is normally distributed with mean 0 and variance $t-s$, i.e., for any $a\lt b$, </li>
</ul>
<p>$$
 P[a \leq B_t - B_s \leq b] = \frac{1}{\sqrt{2\pi(t-s)}}\int_a^b e^{-\frac{x^2}{2(t-s)}}dx.
$$</p>
<ul>
<li>$B_t$ has independent increment, i.e., for any $0\leq t_1 < t_2 < \cdots < t_n$, the random variables
$$
  B_{t_1}, \; B_{t_2} - B_{t_1},\; \cdots, \; B_{t_n} - B_{t_{n-1}}
$$
are independent.</li>
</ul>
<ul>
<li>Almost all sample paths of $B_t$ are continuous functions, i.e.,
$$
  P[\omega:B_t(\omega) \mbox{ is continuous } ] = 1
$$</li>
</ul>
<h3 id="Remark">Remark<a class="anchor-link" href="#Remark">¶</a></h3><ul>
<li>A Brownian motion is sometimes defined as a stochastic process satisfying only the first 3 conditions in the  definition. Such a process always has continuous modification by applying Kolmogorov's continuity criterion.</li>
<li>The standard Brownian motion starts at 0. A Brownian motion starts at $x\neq 0$ is obtain by shifting $x + B_t$.</li>
</ul>
<ul>
<li>$ E({B_t}) = 0$ for all $t$</li>
</ul>
<ul>
<li>$ cov(B_t,B_s) = \min\{s,t\}$ </li>
</ul>
<p>To calculate the covariance, without loss of generality, we assume $s < t$.</p>
<p>\begin{eqnarray*}
   cov(B_t,B_s) &=& E({B_t\, B_s}) = E({(B_t - B_s + B_s)B_s}) =  E{(B_t - B_s)B_s} + s \\
  &=& E({B_t - B_s})\,E({B_s}) + s \quad (\because \mbox{ independent increment}) \\
  &=& s = \min\{s,t\}.
\end{eqnarray*}
$$
\newcommand{\bea}{\begin{eqnarray}}
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\supp}{\mathrm{supp}}
\newcommand{\F}{\mathcal{F} }
\newcommand{\cF}{\mathcal{F} }
\newcommand{\E}{\mathbb{E} }
\newcommand{\Eof}[1]{\mathbb{E}\left[ #1 \right]}
\def\Cov{{ \mbox{Cov} }}
\def\Var{{ \mbox{Var} }}
\newcommand{\1}{\mathbf{1} }
\newcommand{\p}{\partial}
\newcommand{\P}{\mathbb{P} }
\newcommand{\PP}{\mathbb{P} }
\newcommand{\Pof}[1]{\mathbb{P}\left[ #1 \right]}
\newcommand{\QQ}{\mathbb{Q} }
\newcommand{\R}{\mathbb{R} }
\newcommand{\DD}{\mathbb{D} }
\newcommand{\HH}{\mathbb{H} }
\newcommand{\spn}{\mathrm{span} }
\newcommand{\cov}{\mathrm{cov} }
\newcommand{\HS}{\mathcal{L}_{\mathrm{HS}} }
\newcommand{\Hess}{\mathrm{Hess} }
\newcommand{\trace}{\mathrm{trace} }
\newcommand{\LL}{\mathcal{L} }
\newcommand{\s}{\mathcal{S} }
\newcommand{\ee}{\mathcal{E} }
\newcommand{\ff}{\mathcal{F} }
\newcommand{\hh}{\mathcal{H} }
\newcommand{\bb}{\mathcal{B} }
\newcommand{\dd}{\mathcal{D} }
\newcommand{\g}{\mathcal{G} }
\newcommand{\half}{\frac{1}{2} }
\newcommand{\T}{\mathcal{T} }
\newcommand{\bit}{\begin{itemize}}
\newcommand{\eit}{\end{itemize}}
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\tr}{\mbox{tr}}
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Two simulation of Bronian motion are as following</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Paley-Wiener-expansion-of-Brownian-motion">Paley-Wiener expansion of Brownian motion<a class="anchor-link" href="#Paley-Wiener-expansion-of-Brownian-motion">¶</a></h2><p>The Paley-Wiener representation of a Brownian path in terms of a random Fourier series.</p>
<p>Let $\xi_n$ be an iid sequence of standard normal variables. Then</p>
<p>$$
B_t=\xi_0 t+ \sqrt{2}\sum_{n=1}^\infty\xi_n\frac{\sin( n\pi t)}{n \pi}
$$</p>
<p>and</p>
<p>$$
B_t = \sqrt{2} \sum_{n=1}^\infty \xi_n \frac{\sin \left(\left(n - \frac{1}{2}\right) \pi t\right)}{ \left(n - \frac{1}{2}\right) \pi} 
$$</p>
<p>represent a Brownian motion on [0,1].</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For Brownian motion $B_t$, since the random variable
$B_{t+h} - B_t$ is centered Gaussian with variance $h$, we have</p>
<p>$$
   E{(B_{t+h} - B_t)^4} = 3 h^2.
$$</p>
<p>Therefore, by taking $\alpha=4$, $\beta = 1$, and $C=3$, the Kolmogorov's continuity criterion applies.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># the following function plots the Brownian motion path by the Paley-Wiener expansion</span>
plotBM <span class="o"><-</span> <span class="kr">function</span><span class="p">(</span>N<span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">)</span>
<span class="p">{</span>
  xi0 <span class="o"><-</span> rnorm<span class="p">(</span><span class="m">1</span><span class="p">)</span>
  xi <span class="o"><-</span> rnorm<span class="p">(</span>N<span class="p">)</span>
  W <span class="o"><-</span> <span class="kr">function</span><span class="p">(</span>N<span class="p">)</span> <span class="p">{</span>
    <span class="kr">if</span> <span class="p">(</span>N<span class="o">==</span><span class="m">0</span><span class="p">)</span>
      res <span class="o"><-</span> <span class="kr">function</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span> xi0<span class="o">*</span><span class="kp">t</span>
    <span class="kr">else</span> <span class="p">{</span>
      coeff <span class="o"><-</span> xi<span class="o">/</span><span class="p">(</span><span class="m">1</span><span class="o">:</span>N<span class="p">)</span><span class="o">/</span><span class="kc">pi</span>
      res <span class="o"><-</span> <span class="kr">function</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span> xi0<span class="o">*</span>t <span class="o">+</span> <span class="kp">sqrt</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="o">*</span><span class="kp">sum</span><span class="p">(</span>coeff<span class="o">*</span><span class="kp">sin</span><span class="p">(</span><span class="kp">seq</span><span class="p">(</span><span class="m">1</span><span class="o">:</span>N<span class="p">)</span><span class="o">*</span><span class="kc">pi</span><span class="o">*</span><span class="kp">t</span><span class="p">))</span> 
    <span class="p">}</span>
    res
  <span class="p">}</span>
  
  vW <span class="o"><-</span> <span class="kr">function</span><span class="p">(</span><span class="kp">t</span><span class="p">)</span> <span class="kp">sapply</span><span class="p">(</span><span class="kp">t</span><span class="p">,</span><span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> W<span class="p">(</span>N<span class="p">)(</span>x<span class="p">))</span>
  curve<span class="p">(</span>vW<span class="p">,</span>from<span class="o">=</span><span class="m">0</span><span class="p">,</span>to<span class="o">=</span><span class="m">1</span><span class="p">,</span>col<span class="o">=</span><span class="kp">col</span><span class="p">,</span>xlab<span class="o">=</span><span class="s">'t'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'BM'</span><span class="p">)</span>  
<span class="p">}</span>
par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>                          
plotBM<span class="p">(</span><span class="m">20</span><span class="p">)</span>
plotBM<span class="p">(</span><span class="m">200</span><span class="p">,</span>col<span class="o">=</span><span class="s">'red'</span><span class="p">)</span>       
plotBM<span class="p">(</span><span class="m">20000</span><span class="p">,</span>col<span class="o">=</span><span class="s">'green'</span><span class="p">)</span>
plotBM<span class="p">(</span><span class="m">200000</span><span class="p">,</span>col<span class="o">=</span><span class="s">'green'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
QKQ87qdvL+fb6FekxS6+TremikiWXo/PXETqjOlE2uyvlUT66ItIVXKsz0wiLXbAr0ibI9R2
+niWlXUXByJVybE6O0EOjEGkVFYHvKNr/ef631W5e5FOrDqqywZEygKR3Ip0UmVEqo5RpDyP
EOn75kok0zkaIvXGXpDZRHrVFenYDETyDCKVFmmzh6tE2vYamM4ItSLdgr/mlsSIIoWdqSxS
qTY6ESkwZxOZhn0PDxjdtUiv7LZJKLtXjCJlehS/oQq1UUikxbLdVGhpJAOLpGsm9yJZpaku
UqE2Wn2hYUMZkbZxhUSKKEZ7jaRpJkQykrShCrQRIh0vTO1syD/7RiQziRtK3kYfkU67ExDp
nF1KOhuM0uR6lLGh1J0NiCQXiSOSuau7mUjuj0i7MKVIJ1WueI1kiIv6yRCP9C2S4sSuO5FO
0kWItPupJZtIoRI+lOu1u+0m0svuk55FMlr0se0oOSLt5qpEsjbRdRmTiJTtUbn7SLdPWrtI
n567NT2KdBi+Ecl4BqkVyXrXfHyRrN89qi9SZBvdTopoKpI5KkOk4AG20qldbHJEyqTUhrp9
X6NEOlelgUgLuW0iff93L9L410hGkfI9Ki7S/xO2D7vnsUgnJ0qHM6+IEen5mTLEL0UKHWDr
iHR7n1lfRo7ea9ezSMY2WrfpddFvkU53s/OdMI6xRbr9tVC2B4OKZH5El5n4zgZrG12eNmxE
+vdvFJFefx8LbTobvtNzj2wwPsNO4FHaWXWJNtr0Gu+XHS5uIdJx+FeJZ/BUNeGjApFSQaTX
ftnh4hSRImKyRNqn61Skdbpg12zUj3z3wbQiHdCJSBfdh9sCXIl0keObuzeXTqp7P5hOpYJI
EddIB7gVKZDOs0gvZ4cl428hSVaJI9J1UkRa4sgkRNrgUKRQP8NJpFgk84M1Uu4juTHJ+sPL
bUTKffhJSnx3IhnCW4oUnz5qZIMXk4wiaVanXPem8Kb56V0WREpJuU0eNdbOiUkX1bxvXvMo
JpJyGBciGakkkg+Trip5tyUzUnysXWwbBXku/h8sjAORNskjG8mDSZd1vNuS2UCk66RpIsXU
9jzj3q6RXi5Euq7i3ZbMhiORjvbePkWK0r6VSOkXsv2bZKjh3ZbMhItrJLlIUSGBTu8MkYLz
m4mUnGP3IpkqeNeth4teO0QyUk+k7k2y1U+3Fg1H9/oVyRSOSC2pXj1EikgcJVJM2Q5F6tuk
+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
VAAAAABJRU5ErkJggg==" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The other one is Donsker's invariance principle</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Donsker's invariance principle is also referred to as the Donsker's theorem.</li>
</ul>
<p>Suppose $\{X_i\}_{i=1}^\infty$ is an iid sequence of random variables with mean 0 and and variance 1. Let $S_n = \sum_{i=1}^n X_i$. Define the function $\mathfrak{S}_n$ of $t$ by</p>
<p>$$
  \mathfrak{S}_n(t) = \frac1{\sqrt n}\sum_{i=1}^n\left[S_{i-1} + n \left( t-\frac{i-1}n \right) X_i \right]\,1_{\left(\frac{i-1}n,\frac in\right]}(t) .
$$</p>
<p>In fact, $\mathfrak{S}_n$ is simply the linear interpolation of the scaled random walk $\left\{\frac{S_1}{\sqrt n}, \frac{S_2}{\sqrt n}, \cdots, \frac{S_n}{\sqrt n} \right\}$.</p>
<p>Then, $\mathfrak{S}_n\Longrightarrow W$ as $n\to\infty$, where $W$ denotes a Brownian motion.</p>
<p>In other words, as $n\to\infty$, the linearly interpolated scaled random walk $\mathfrak{S}_n$ converges weakly to a Brownian motion.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># Simulate BM by using the Donsker's invariance principle</span>
N <span class="o"><-</span> <span class="m">1000</span>
par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
nu <span class="o"><-</span> <span class="m">3</span>
X <span class="o"><-</span> rt<span class="p">(</span>N<span class="p">,</span>df<span class="o">=</span>nu<span class="p">)</span>
BM <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="kp">cumsum</span><span class="p">(</span>X<span class="p">)</span><span class="o">/</span><span class="kp">sqrt</span><span class="p">(</span>N<span class="p">))</span>
t <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,(</span><span class="m">1</span><span class="o">:</span>N<span class="p">)</span><span class="o">/</span>N<span class="p">)</span>
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span>BM<span class="p">,</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">)</span>

X<span class="o"><-</span> rnorm<span class="p">(</span>N<span class="p">)</span>
BM <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="kp">cumsum</span><span class="p">(</span>X<span class="p">)</span><span class="o">/</span><span class="kp">sqrt</span><span class="p">(</span>N<span class="p">))</span>
t <span class="o"><-</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,(</span><span class="m">1</span><span class="o">:</span>N<span class="p">)</span><span class="o">/</span>N<span class="p">)</span>
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span>BM<span class="p">,</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
kCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQI
EBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQE
AUKCACFBgJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQ
IEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQ
EgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQIEBIECAkChAQB
QoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAg
QEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBAS
BAgJAoQEAUKCACFBgJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFC
ggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBA
SBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQIEBIE
CAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKC
ACFBgJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBI
ECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQI
CQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQIEBIECAkChAQBQoIA
IUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQ
ICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJ
AoQEAUKCACFBgJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAh
QYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAg
JAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQIEBIECAkC
hAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFB
gJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKEBAFCggAhQYCQIEBIECAk
CBASBAgJAoQEAUKCACFBgJAgQEgQICQIEBIECAkChAQBQoIAIUGAkCBASBAgJAgQEgQICQKE
BAFCggAhQYCQIEBIECAkCBASBAgJAoQEAUKCACFBgJAgQEgQICQI+B+xEF78dnXyvAAAAABJ
RU5ErkJggg==" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Simulation-of-Brownian-motion">Simulation of Brownian motion<a class="anchor-link" href="#Simulation-of-Brownian-motion">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># the code demonstrates how to simulate Brownian paths </span>

NSim <span class="o"><-</span> <span class="m">10000</span><span class="c1"># number of samples at each step</span>
NSteps <span class="o"><-</span> <span class="m">100</span>   <span class="c1"># number of steps </span>
Tfin <span class="o"><-</span> <span class="m">1</span>    <span class="c1"># terminal time</span>
B <span class="o"><-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span>NSim<span class="p">,</span>NSteps<span class="m">+1</span><span class="p">)</span>  <span class="c1"># initialize the Brownians</span>

<span class="c1"># simulation step</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>NSteps<span class="p">){</span>
  dB <span class="o"><-</span> rnorm<span class="p">(</span>NSim<span class="p">)</span>
  dB <span class="o"><-</span> dB <span class="o">-</span> <span class="kp">mean</span><span class="p">(</span>dB<span class="p">)</span>  <span class="c1"># now dB has mean 0</span>
  dB <span class="o"><-</span> dB<span class="o">/</span>sd<span class="p">(</span>dB<span class="p">)</span>  <span class="c1"># now dB has variance 1</span>
  dB <span class="o"><-</span> <span class="kp">sqrt</span><span class="p">(</span>Tfin<span class="o">/</span>NSteps<span class="p">)</span><span class="o">*</span>dB
  B<span class="p">[,</span>i<span class="m">+1</span><span class="p">]</span> <span class="o"><-</span> B<span class="p">[,</span>i<span class="p">]</span> <span class="o">+</span> dB
<span class="p">}</span>

t <span class="o"><-</span> <span class="p">(</span><span class="m">0</span><span class="o">:</span>NSteps<span class="p">)</span><span class="o">/</span>NSteps<span class="o">*</span>Tfin
par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>

<span class="c1"># plot a Browian path</span>
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span>B<span class="p">[</span><span class="m">5000</span><span class="p">,],</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'Bt sample path'</span><span class="p">)</span>

<span class="c1"># histograms superimposed with normal distributions at different times </span>
hist<span class="p">(</span>B<span class="p">[,</span><span class="m">100</span><span class="p">],</span>prob<span class="o">=</span><span class="bp">T</span><span class="p">,</span>breaks<span class="o">=</span><span class="m">50</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1.5</span><span class="p">),</span>xlab<span class="o">=</span><span class="s">'B'</span><span class="p">)</span>
curve<span class="p">(</span>dnorm<span class="p">,</span>col<span class="o">=</span><span class="s">'orange'</span><span class="p">,</span>add<span class="o">=</span><span class="bp">T</span><span class="p">)</span>
hist<span class="p">(</span>B<span class="p">[,</span><span class="m">10</span><span class="p">],</span>prob<span class="o">=</span><span class="bp">T</span><span class="p">,</span>breaks<span class="o">=</span><span class="m">25</span><span class="p">,</span>col<span class="o">=</span><span class="s">'green'</span><span class="p">,</span>add<span class="o">=</span><span class="bp">T</span><span class="p">)</span>
curve<span class="p">(</span>dnorm<span class="p">(</span>x<span class="p">,</span>sd<span class="o">=</span><span class="m">1</span><span class="o">/</span><span class="kp">sqrt</span><span class="p">(</span><span class="m">10</span><span class="p">)),</span>add<span class="o">=</span><span class="bp">T</span><span class="p">,</span>col<span class="o">=</span><span class="s">'red'</span><span class="p">)</span>

<span class="c1"># evolution of mean</span>
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span><span class="kp">apply</span><span class="p">(</span>B<span class="p">,</span><span class="m">2</span><span class="p">,</span>FUN<span class="o">=</span><span class="kp">mean</span><span class="p">),</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>xlab<span class="o">=</span><span class="s">'t'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'mean'</span><span class="p">)</span>
abline<span class="p">(</span>h<span class="o">=</span><span class="m">0</span><span class="p">,</span>col<span class="o">=</span><span class="s">'red'</span><span class="p">)</span>

<span class="c1"># evolution of standard deviation</span>
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span><span class="kp">apply</span><span class="p">(</span>B<span class="p">,</span><span class="m">2</span><span class="p">,</span>FUN<span class="o">=</span>sd<span class="p">),</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>xlab<span class="o">=</span><span class="s">'t'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'sd'</span><span class="p">)</span>
curve<span class="p">(</span><span class="kp">sqrt</span><span class="p">(</span>x<span class="p">),</span>add<span class="o">=</span><span class="bp">T</span><span class="p">,</span>col<span class="o">=</span><span class="s">'red'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
AAAASUVORK5CYII=" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Brownian-motion-with-drift">Brownian motion with drift<a class="anchor-link" href="#Brownian-motion-with-drift">¶</a></h2><p>Let $(\Omega,F_t,P)$ be a filtered probability space and $B_t$ a Brownian motion on $\Omega$. 
A stochastic process $X$ of the form</p>
<p>$$
X_t = x + B_t + \int_0^t \mu_s ds \quad \Longleftrightarrow \quad dX_t = dB_t + \mu_t dt
$$</p>
<p>is called a Brownian motion with drift $\mu_t$, where $\mu$ is adapted to the filtration $F_t$.</p>
<h4 id="Remark">Remark<a class="anchor-link" href="#Remark">¶</a></h4><ul>
<li>$X_t$ is a Gaussian process if $\mu_t$ is deterministic. Apparently, the mean function is $E({X_t}) = x + \int_0^t \mu_s ds$ and the covariance function $\gamma(t,s) = cov(X_t,X_s) = \min\{t,s\}$.</li>
</ul>
<ul>
<li>We can always transform a Brownian motion with drift into a standard Brownian motion by change of the underlying probability measure so long as the drift $\mu_t$ satisfies certain conditions, say, bounded.  </li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Ito-Integral-and-Ito-Formula">Ito Integral and Ito Formula<a class="anchor-link" href="#Ito-Integral-and-Ito-Formula">¶</a></h1><p>Let's start with defining the simple integral as</p>
<p>$$
  \int_0^t B_s dB_s.
$$</p>
<p>As in the theory of Riemann-Stieltjes integral, we shall start with partitioning the interval $[0,t]$ into, say, $n$ subintervals. Within each subinterval, we pick a point and evaluate the integrand at that point, multiply that value by the increment of the integrator in that subinterval. Then we sum up the results from each subinterval and take limit as the mesh of the partition approaches zero. Possible choices for selecting points from each subinterval  may be, denoting $\Delta B_{t_k} = B_{t_k} - B_{t_{k-1}}$:</p>
<ul>
<li>The right point rule:
  $$
  R_n = \sum_{k=1}^n B_{t_k} \Delta B_{t_k}
  $$</li>
</ul>
<ul>
<li>The left point rule:
  $$
  L_n = \sum_{k=1}^n B_{t_{k-1}} \Delta B_{t_k}
  $$</li>
</ul>
<ul>
<li>The midpoint rule:
  $$
  M_n = \sum_{k=1}^n B_{t_*} \Delta B_{t_k}, \quad \mbox{ where } t_* = \frac{t_k + t_{k-1}}2
  $$</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Which-rule-rules?">Which rule rules?<a class="anchor-link" href="#Which-rule-rules?">¶</a></h2><p>From above we have two different expressions for the integral. The point is, Which rule yields convergent integral? in what sense? We knew that it can't be pathwise because the integrator, in this case the Brownian motion, is not of finite variation (because it has nonzero second variation) almost surely.</p>
<p>Note that the following identities hold.
\begin{eqnarray*}
  && R_n - L_n = \sum_{k=1}^n \left( \Delta B_{t_k} \right)^2,  \qquad 
  R_n + L_n = \sum_{k=1}^n \Delta B_{t_k}^2 = B_t^2.  \\
\end{eqnarray*}
Hence,
\begin{eqnarray*}
  && R_n = \frac{B_t^2}2 + \frac12 \sum_{k=1}^n \left( \Delta B_{t_k} \right)^2,  \qquad 
   L_n = \frac{B_t^2}2 - \frac12 \sum_{k=1}^n \left( \Delta B_{t_k} \right)^2.
\end{eqnarray*}
Notice that the first term in both expressions is independent of partitions and the second term, as we have seen in previous lecture, will converge to the quadratic variation of Brownian motion in $L^2$ as the mesh approaches zero! Consequently,
\begin{eqnarray*}
  && \lim_{\|\Pi_n\|\to0} R_n = \frac{B_t^2}2 + \frac t2,  \qquad
   \lim_{\|\Pi_n\|\to0} L_n = \frac{B_t^2}2 - \frac t2.
\end{eqnarray*}</p>
<p>So we learnt from this simple example that</p>
<ul>
<li>The right point rule and the left end point rule yield different "integrals".</li>
</ul>
<ul>
<li>The difference between the "right integral" and the "left integral" is exactly the quadratic variation.</li>
</ul>
<ul>
<li>The convergence is in $L^2$ sense.</li>
</ul>
<h4 id="Remark">Remark<a class="anchor-link" href="#Remark">¶</a></h4><ul>
<li>We need to stick with one specific rule in order to have convergence.</li>
<li>Ito picked the left end point rule because of adaptivity and martingality.</li>
<li>$L_n$ is a martingale whereas $R_n$ isn't.</li>
<li>The midpoint rule leads to the Stratonovich integral.</li>
<li>What needs to notice is the respective sensitivity of different rules to the first and second order moment as: 
$E(\frac{B_t^2}2 + \frac t2) = t$ while $E(\frac{B_t^2}2 - \frac t2) = 0$, which is the most difference of the two rules. The following is a little test for this.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Simulation-of-stochastic-integral:-left-endpoint-rule">Simulation of stochastic integral: left endpoint rule<a class="anchor-link" href="#Simulation-of-stochastic-integral:-left-endpoint-rule">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># Simulate the stochastic integral int f(B) dB from 0 to t, for t in [0,1]</span>
<span class="c1"># Demonstrate the effect of Ito correction/term </span>

NSim <span class="o"><-</span> <span class="m">1e4</span>   <span class="c1"># number of samples at each step</span>
NSteps <span class="o"><-</span> <span class="m">100</span>   <span class="c1"># number of steps </span>
Tfin <span class="o"><-</span> <span class="m">1</span>    <span class="c1"># terminal time</span>
dt <span class="o"><-</span> Tfin<span class="o">/</span>NSteps
f <span class="o"><-</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> x 
B <span class="o"><-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span>NSim<span class="p">,</span>NSteps<span class="m">+1</span><span class="p">)</span>  <span class="c1"># initialize the Brownians</span>
dB <span class="o"><-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span>NSim<span class="p">,</span>NSteps<span class="m">+1</span><span class="p">)</span>

<span class="c1"># Simulate Browian paths</span>
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>NSteps<span class="p">){</span>
  db <span class="o"><-</span> rnorm<span class="p">(</span>NSim<span class="p">)</span>
  db <span class="o"><-</span> db <span class="o">-</span> <span class="kp">mean</span><span class="p">(</span>db<span class="p">)</span>  <span class="c1"># now db has mean 0</span>
  db <span class="o"><-</span> db<span class="o">/</span>sd<span class="p">(</span>db<span class="p">)</span>  <span class="c1"># now db has variance 1</span>
  dB<span class="p">[,</span>i<span class="p">]</span> <span class="o"><-</span> <span class="kp">sqrt</span><span class="p">(</span>dt<span class="p">)</span><span class="o">*</span>db
  B<span class="p">[,</span>i<span class="m">+1</span><span class="p">]</span> <span class="o"><-</span> B<span class="p">[,</span>i<span class="p">]</span> <span class="o">+</span> dB<span class="p">[,</span>i<span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Calculate the (discretized) stochastic integral using left endpoints</span>
dX <span class="o"><-</span> f<span class="p">(</span>B<span class="p">)</span><span class="o">*</span>dB
X <span class="o"><-</span> <span class="kp">t</span><span class="p">(</span><span class="kp">apply</span><span class="p">(</span>dX<span class="p">,</span><span class="m">1</span><span class="p">,</span>FUN<span class="o">=</span><span class="kp">cumsum</span><span class="p">))</span>
t <span class="o"><-</span> <span class="p">(</span><span class="m">0</span><span class="o">:</span>NSteps<span class="p">)</span><span class="o">*</span>dt
    
<span class="c1"># plots</span>
par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
    
<span class="c1"># evolution of mean</span>
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span><span class="kp">colMeans</span><span class="p">(</span>X<span class="p">),</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'mean'</span><span class="p">)</span>
    
<span class="c1"># evolution of variance</span>
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span><span class="kp">apply</span><span class="p">(</span>X<span class="p">,</span><span class="m">2</span><span class="p">,</span>FUN<span class="o">=</span>var<span class="p">),</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'variance of X'</span><span class="p">)</span>
    
<span class="c1"># histogram at terminal time</span>
hist<span class="p">(</span>X<span class="p">[,</span>NSteps<span class="p">],</span>prob<span class="o">=</span><span class="bp">T</span><span class="p">,</span>col<span class="o">=</span><span class="s">'green'</span><span class="p">,</span>breaks<span class="o">=</span><span class="m">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
RU5ErkJggg==" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Simulation-of-stochastic-integral:-right-endpoint-rule¶">Simulation of stochastic integral: right endpoint rule¶<a class="anchor-link" href="#Simulation-of-stochastic-integral:-right-endpoint-rule¶">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># What happens if we use right endpoints? </span>

<span class="c1"># Calculate the (discretized) stochastic integral using right endpoints</span>
B <span class="o"><-</span> B<span class="p">[,</span><span class="m">-1</span><span class="p">]</span>
dB <span class="o"><-</span> dB<span class="p">[,</span><span class="m">1</span><span class="o">:</span>NSteps<span class="p">]</span>
dX <span class="o"><-</span> f<span class="p">(</span>B<span class="p">)</span><span class="o">*</span>dB
X <span class="o"><-</span> <span class="kp">t</span><span class="p">(</span><span class="kp">apply</span><span class="p">(</span>dX<span class="p">,</span><span class="m">1</span><span class="p">,</span>FUN<span class="o">=</span><span class="kp">cumsum</span><span class="p">))</span>
t <span class="o"><-</span> <span class="p">(</span><span class="m">1</span><span class="o">:</span>NSteps<span class="p">)</span><span class="o">/</span>NSteps<span class="o">*</span>Tfin

<span class="c1"># plots</span>
par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
    
<span class="c1"># evolution of mean</span>
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span><span class="kp">colMeans</span><span class="p">(</span>X<span class="p">),</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'mean'</span><span class="p">)</span>
    
<span class="c1"># evolution of variance</span>
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span><span class="kp">apply</span><span class="p">(</span>X<span class="p">,</span><span class="m">2</span><span class="p">,</span>FUN<span class="o">=</span>var<span class="p">),</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'variance of X'</span><span class="p">)</span>
    
<span class="c1"># histogram at terminal time</span>
hist<span class="p">(</span>X<span class="p">[,</span>NSteps<span class="p">],</span>prob<span class="o">=</span><span class="bp">T</span><span class="p">,</span>col<span class="o">=</span><span class="s">'green'</span><span class="p">,</span>breaks<span class="o">=</span><span class="m">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA0gAAANICAMAAADKOT/pAAAANlBMVEUAAAAAAP8A/wBNTU1o
aGh8fHyMjIyampqnp6eysrK9vb3Hx8fQ0NDZ2dnh4eHp6enw8PD////oRfzpAAAACXBIWXMA
ABJ0AAASdAHeZh94AAAfF0lEQVR4nO3di3qbuhZFYXWnadq0acP7v+yO8Q1sbhJTaC1p/N85
u2lrwEGMYi6xQwdgt1D6CQA1ICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIE
CAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJ
ECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAg
JECAkAABQgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQICRA
gJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJECAkQCA6
pHCR48kAXsUGEZ6+ABDbQ5j8cvwQbJQ8aLuV/s792L5KI0dgfUp2VRuVDKncon0hJAcIyb5s
IW04RmKQNiIk+/KFtH7WjkHaiJDsyxhSgTlWKteKOs+Xf+wUCMmBrCHd/3PkoqtDSA7kDCks
L4Ix2uiIkMZTppx6bxwh2cceyapv9y8JyaikMSKkQw3GKF9IXy8KwvISGKMFaWNESEcajlHO
FXV+gc1ZuySEZN6oI64j2ZT4jx0hHebbuCNCsumYkDbcGMsgTfv2+AeEZFHqq4bke+1kc2zD
4+6oO2RFcYki2lEhrU/AIE14zog9kknJL7/jV+naFAzSs6mOCMmgx4HiZIMpkx0RkkGEZNjE
4VEv34riR10S7TghREi5zWSUcUXxw5eJ9pwQIqS85nZHXe6fR1pcBGM0ZWKoCMmI+YwIyRxC
MmupI0KyZfK1AyGZsNgRx0im7D2zSkj5LHfEWTtLdp9ZJaRsVjriOpIhc2NFSOWtdURIhhCS
VQunva8IyQzBtT5CymI9I0KyQ3Gtj5By2NIRIVmxMFqEVNSmjgjJCkIyaltHhGSE5u4TQlLb
cJrhjJBMEN19QkhiWzMiJBtUd58QktTm3VFHSDYQkkURGRGSCbLbuAhJKKojQrKAkAyK64iQ
DNDdD0lIKjGHRz1CKo+QzInNiJAsICRjondHHSEZILxDP3qVnj8whB8aG0nIiJAMKBhSOP0v
LE3Y3iCl7I46QipP+aMukas03KfhjTUu0jIipPIIyZLUjgiptA0jR0iHSe6IkEorGRLHSGOJ
h0c9QipL+1PMnLXbY0dG+VfUwvxbGqM54p9i5jpSuj27o46QylL/FDMhJduXUb4Vxef8bkFI
VuztKN+KCqvzb2WM5snfDiB9lY6nbO6Dfnd3lHFrDoOTqwcv2ocMbwfAHinN/o6yrqgQCGle
jrcDIKQUO08znOVdUYGQ5mR5OwBCSqDIKPuKWnqN3cAYzYsZvazXkZr/yBBNR1yQLSPT+2ok
3NmwMmH1gyTqiJCKyPW+Gin32i1PWfkgSQ6PegesqMbPrE4hJBtkGbFHKiLbG9QQUgzd7qgj
pBLyvUENx0gRlBkRUgHRA8hZuxy0HWW9s6HZMVqU852euI60mbij7PfatfmqYUHWd3oipK3U
HeW7+3t9EbWO0aKUASQkOXlHhHSszG+ZRkgbEZJvud8yjZC20XfEMdKREsePkLSk14+uOGt3
nPzvPUhIG+TIiOtIBzrgvQcJaVWW3VG3a0XtXcfVjdEKQjIgU0Y7birZv4prG6MVR7yJJyEt
y7U76lJuKkmdcP+ifSOk4vJllLKiLm/OWWLRnh3ybriEtCRnR0kravGdGPIu2q09g0hIElk7
SltRmrVb0RitOuhtpQlpXt6O2CMd4qi3lSakWZk74hjpCDsHkZD2y90RZ+0OcNz7sxPStIyn
va+4jpTdge/PTkiT8mfEnQ35Hfn+7IQ04YDdUce9dvkRUlmHZERI2R36QQeE9OiY3VFHSLkd
+0EHhPTgqIwIKTdCKum4jggpL8lIElKiAztKOf2tWreux2gj4yFdLq5X+mPMR3ZESFkd/RlW
KVcFw+KEjgfp0I4S7myQfZqE4zHa6PDPsIpcpbeO5qf0O0jHdpSyotgjbXT8Z1gR0tVhp72v
Mq+oWl9+b1HgM6wI6eLojDKuqHD9TPMaX35voRtLjpEiHb476lJ/sG/9CGnwsxaV/WO3lYeQ
6nzzwQIZpf5g3/qUYf2BHsdouyKfqsh1pK5QR3tONixO2npIZT5VkZBKdZQtpPvfzr5u8DdG
20lHk5C2K3F41MsW0u10UF3HsduU+njS9FU6ntLtR8+XyijfMVKmRftQ7ONJG98jFdsddfnO
2uVatAflPp607ZAKZsTd3zmYCKm5+7hK7o66Q1ZUJS+/Nyv4Ob9h4qvlCaq5jlQ2I/ZIeiU/
njQ2pPD0Rfqyiyq8O+oISc9RSGHyy8Rll1Q8I0KSK/o5v42GZKCjjCuqnpffUYyEtGmiSkKy
0FHGu79Xl+BhjKKV/cDswR5p0xmdKgbJREfJ15E23tewtAgHYxQty6By9/cSGx2l3tkQNt9q
11RIpT95vsELskY6Sr3X7vr/LfNtJ6Tinzzf3AXZ8qe9r3KFVMfL7zi5BjXxrN36GEmXXYKZ
jDKGVMPL7zjZRnVHSLtXsulBMtRRtmOkTIs2LN+opl5HUuySLA+SpY64+1sl46gS0iRTHXFn
g4qxkFQHSXYHyVZHhCSSc1jTTn+HbvFdBeXLPpixjhJf2qVOuH/RRmUdVq4jPbFz2vsq8WRD
4pS7F20VIR3KXEbJp78TJ927aKvyDmziS7v1+7ikyz6QwY4IScJgSBVfo7DYESEpZB5ZTn+P
mOyIYySB3CNLSAP2TjOccUF2t+wjS0h3RjPiOtJ++YeWY6Qrq7ujjpB2O2Bok8/a1faywW5G
icdITfyoyzZHjC3Xkc4sd7TnrF2BRZtzyNgS0hkh5Z1PQccMLSH1THdESHscNLRpJxsqe/1t
+DxDj5DSHTW0qae/j112XsYz2nNBtsiiLTlsbAnJ+u6oS9sj1faqIVE9IS082MQg2c+I60jp
jhvd1AuyigVYGCQPHRFSqgNHN9vJhsFnVc09zsAguego4wXZ2wMMj9EOxkPaNs3KCEUtOxcf
HSWetdtwO2T/kLC0iPJjtMORw5vxGGl5hKKWnYmTjnaEtDzp4N+6GkM6dHiznmwIy7e2lh4k
Lx2lXkda3SWF+68VhnTs8GY+2bD4E+llB8nBae+r3CEtDBMhbZS0R4q4RrH0oKKD5Cej5Auy
6wdJ95LqC+ngAW70XjtHu6MucUWFbsN7D4anLxSLNuDwAW4zJFcZcR0p3vEDfERI4ynXry9l
56wjQopVYIBb3CN564iQIpUY4AZDctdR9IoK8TetmnvVsAchHcFfR+yR4hQZ4Ywh2fxYRYcd
pV5HKrTo0sqMcL6QVs+slhgkX6e9rwgpQqERzhbShhshjh8klxnlDMnmq4Y9Sg1xSyH53B11
yXc2RDzI0quGXYoNcUMhec0obY+06WfG1hfhLKRyY9zMMZLb3VGXb0XVFlLJMW7lrJ3jjAhp
o6Jj3MZ1JM+7oy7xGGnLBVVjrxp2KTzGTYTkO6PUs3brP0Vh7FXDLqXHuIWQSq/j3dJD2r2O
nYRU/iUHITmQeB1pyy4pw6ILMDDCDYRkYC3vREjLLIxw9SGV3+nvl3hBtpWQTIxw7SGZWMl7
Ja2o889SFFn0oYz8S1l3SEZW8l78GMU8KyNcdUhWVvJehDTLzBBXHFIlu6OOkObZGeJ6Q7Kz
jndLumm12KKPZGeQqw3JzireL+1kg6Ql2yEZGuRaQzK0ivdLXVGClCyHZOq1e50hmVrF+6Wv
qJo/+tLWGFcZkq1VvB97pAnGBrnCkCrbHXUcI00yNsr1hWRsBStw1u6ZtWGuLiRrK1iB60hP
zA1zbSGZW8EKhPTI3jBXFpK9FaxASA8MDnNVIdV3muGMkEZMDnNNIVlcvxKENGRzmCsKyeYK
ViCkO5O7o66mkIyuYAVCujE7yhlDul0RnJtSOkhm17AAIV1Y3R11OUPq3zEgLE2pHCS7a1iA
kM4sD3K2kAZ7owNCsryK98u1NQ8+4fKQVw07mR7k3CFd381GMMd5hvf4Etm25vUZE9JG2UP6
+iJ3SKZXsEK+rXl1zoZCsj3MeY+Rzl/kDan23VGXdWtem7WZkKwPc86zdmtTSgbJ+PqV4GSD
/WH2fh3J/ApWaD4k67ujzn1I9lewQusheRhl1yE5+IdKovGQXIzyESGNp1y/drGVixWscMDW
nGuMBHwMs+M9ko8VrND0HsnJMPsNyckKVmg5JC/D7DYkLytYoeGQ3Axz3ru/s33QbyunGc4y
3tlg+8OYHQ3zEXc2qOZ452f9SuS/1y7DGAl4Gub899pluLPB0wpWyHb39/oiCobkaHfU+QzJ
1QpWaDEkXxl5DMnbGhZoLyR/g+zuGMndGhZo7hjJ4SB7O2vncBXv19pZO4+D7Ow6ksdVvF9b
15H8vaw78RWSy1W8X0sh+czIV0he1/Fu7YTkd4gdheR2He/WSkh+M3IUkueVvFcbIfkeYS8h
uV7JezUQ0jffGbkJyfla3qn6kLxX1HkJyf963qXukNzvjHoeQqpiRe9Rc0i1DK6DkCpZ0zvU
G1ItGTkIqZ5Vna7WkGoaW+shVbSq09UZUk0ZWQ+prnWdrMaQahta0yFVtq6T1RdSbRnZDqm6
lZ2qtpDqy4iQXKgqpDouGz0xHFKV6ztJPSFVWlFnOKRq13iCWkKqeUythlTxKo9XRUj17ox6
NkOqe51H8x9S5RV1RkOqfaXHch5S/RV1JkNqYbXHcf0uQo0Mp72Q2ljvUfy+r10TO6Oetfe1
a2bFx8gVUpj8UrbodirqcoaU9K9dQ2s+gseQmqqoyxhS0iC1te43cxbSt2+tVdQRkguejpEa
bKhnKqQ2h2Cdj7N235rcE10ZOkZqdxDWmL+O1HRCZ3bO2jU+EEvMhvTtW9u7oQEr15EYjAXW
QvpGQE+MhMSQLDkgpPEiwt39D7/RzwIjIWGJtT0Snh0R0oZ/7bCEkOxjj+QAIdlHSA74uI7U
NkJywNOdDa2ycx0Js5zda9ckQ3c2YA4h2WfqXjtMIyT7ioaEjeJWfcIgzb9qwEbxKz364WtT
pm4nidPVvbjIhWzdCupeaYcuTn+MlDrnndPVvbhM6l5ppkPiX7sii8uk7pVmO6Tsc/aw1giJ
xYkWlm/OHtYaIbE40cLyzdnDWiMkFidaWL45e1hrhMTiRAvLN2cPa42QWJxoYfnm7GGtERKL
Ey0s35w9rDVCYnGihQEYICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQ
ICRAQB7S+A2Gtr/F3tN02yZ8fFzy4rJO1o2fWMx0OTBGM1MmTvc4rUIYzXP8uwzTPT5w88p+
XtyWKVO/u/HsY6bLgTGamXLPGIkHNIxmOv5dhukeHxgiNondi9v+3Y2fWMx0OTBGc1PuGSOT
IXUTv9s02Z5BSpxs6z/KtYXUTfxu02SVjlFVIYWt38/j09z4gvh5cbEDPDGXwzFGy9NOzCVq
WgnhICVMljpIW9f20z+uSQeyFYXEGE1MK1F0kLb/65P4NNkjMUbr00roBil+Px42T6YZpLiV
XWNIjNHUtBKyQUpY2RGfDeVskLQYo+Vp46eLfezm2e0fpI1PK/EfSW+DpMUYLU8bP13sY7fO
L8z8Lm66hMm2T5n4NFO/u/EDo6bLgDFamDRluodpNa777TD6Xdx0EZ/fOV5cxD8+aU8z9bsb
/xtn5RYhxuhhysTp7lMB2IWQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJECAk
QICQAAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRBoIqQm
vknnvI+R9+e/SRPfpHPex8j789+kiW/SOe9j5P35b7H1c3xQjvsx8v3sN2rim3TO+xh5f/6b
NPFNOud9jLw//02a+Cad8z5G3p//Jk18k855HyPvz3+TJr5J57yPkffnv0kT36Rz3sfI+/Pf
pIlv0jnvY+T9+W/i/RpFC7yPke9nDxhBSIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAh
AQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEC
hAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQE
CBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKHhxRC
GHxx+93NW4Zl/nwJ4TLfvyG89l+8hvD3tPjHJ/D1B+/DJ/r+9cDw40/Uk5uYLSpnLKSPlwxP
6O20XV8b+BnC769ffofwc3KL//qDl8ETfQ1nP2OeHCG1p3BIs38rXuS/++9e+lDO/50O6bxL
6v/md7j6E/HkCKk9jYQ0+F2/L7rslyYWF667pP7vXvt90eeP/gVhxJMjpNaYeGn38eP02uvv
5Z/y/u8/vjbh14/zI78Ocd4+rw//+H7apv+eXq71f//16+dbeHnv/r6Glz+DBd3mEB52EF9/
/n45UpoO6Ue/Sxq+9OyXfp/P1xN6+fl5fsy/t/PrvsF3MT1jVM1CSNfXTx/3bfXn+atfpwf2
hynfrw9/+drQu4/bFJc/Om39lxdgF/c5PIb0t//939GTGT2/f9eXff2yf3zc/+b8+H554eXz
vvBTlffvYnrGqFqJkG4uG9zL6Rjmq43vtw3wdG7t87M/sXbaQF+709fnh39ts5/d99MLs9/X
11tv3Z/+v7/7WZwN5/C4VZ8a+3l9MhPP7+sBPy9/dy72x+/PwaN/nWJ5vzb6+nmq7ffouyCk
9lgIKVzPON82wLf+H/aP/lzbj+vXl5d2o1ldzyTc/nv9u+EcHrfq0wu1z+HiHp7f6QGfl7/7
c9793F/s9Xup/jev1+fzcdpJDr8LQmqPhZD6V2Wvfy5/e/rl5fxLf9gfrl+PzpZ/vr+9Dv5o
+N9uZg43q3ukfpd0/bvfb31Lv4fPZPT0n78LQmqPhWOk7v379UBjuGWO4xmH9ONhW34KaTq/
3uoxUr/P+hz83enUxve1kAbfBSG1x0RIXffv18v19dHpt2t7pK99yuvvz7AQ0sIeafWsXXc6
DvoZLodv98OjceWDLx+/C0Jqj5GQvjbC4e8XjpEGM1kKaf4Yaf060umXl/Mu560/m3B6+D3I
1/v13eEx0uC7IKT2WAjp+2lz/Dt89fQxf9aun/blNMXPpZA+Zs/aPdzZ0I2nu379fg7p7+11
3PvwrN3b/QTD7azd4LsgpPZYCOm6tX6cb4s73RV3uQrUnxLoryONQ/rV/21/wnkmpOEcRlv1
4712XTcZUr9Lus+m3+Vcntzn9/PSz6cJbwdGg++CkNpjIaTu3+nEWH9PwL8fl5dJf17vp8B+
hutJtNvE7y/h+/vnabueC2kwh+EfP939/fiA69fv151jfw/Fqb37k/v1Vc/bv8uD38LL+RTg
/bsgpPa4Ge/BxVblTC/ff+K8Z3shpNbYH+/QH+e8Xy/9qOfdn+1+e19/7Mz0C7NFQ+yP96/L
scfLp37ely3+7Vf69AuzRUMcjPfv09XX7z8zdLR7iyckXDDegAAhAQKEBAgQEiBASIAAIQEC
hAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAtEh
Xd9UPseTAbyKDSI8fQEgtocw+SXQOkICBAgJEOAYCRDgrB0gQBCAACEBAoQECKSHNJ4y3O19
SoA/+s2ekNAgQgIECAkQSLmOtDwlIaFBKXc2nFOKC4nTEKha2r12YWHKmZD+++8/QkK1Em9a
DYQEDKTe/R0ICbhLv/ubkICb+LN2a1MSEhp01HUkQkLVCAkQICRAgJAAAUICBAgJECAkQICQ
AAFCAgQICRAgJECAkAABQgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECAkAAB
QgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJEAg6VPNQ5j9KGZCQpNSQrr/Z/sc
CQlVSwgpLE9JSGgQIQEChAQIxIYUwvWEQ9wcCQlVi9+4z2fsOGsHDHAdCRAgJECAkACB9I17
PGW4m340IaFm7JEAAUICBAgJECAkQICQAIH4W4SWz84REpoUu3GvP56Q0KDojXt1AkJCgxJu
Wk36e0JC1TjZAAgQEiBASIAAIQEChAQIHBrS0vtKAp4dGhI7JdSKkAABQgIECAkQICRAgJAA
AUICBAgJECAkQICQAAFCAgQICRAgJECAkAABQgIECAkQuG/Zqp+6IyQ0aLRlS1p6nkX/BseE
hJo9bNmClCZCOkdESKjX1P5DPkdCQu0et+xTRvtSIiQ0aPIYiZCAOJNn7QgJiHPEdSRCQvUI
CRAIT1/t3dYJCQ0iJEDgsmVv+JDlyDkO/4SQULvnPZJujrc/ISTUjpMNgED0lr36ApCQ0KBw
+2XbMdL6RVtCQoMit+ww+eXKHAkJ1SMkQICQAIGHMlYvI3GMBEwYX0cK3eo+irN2wLPokCLm
ePsTQkLtCAkQICRAYHiyIUR1NH7g0k2vhITqca8dIEBIgMD4pR0/jwQkOfrnkQSlAvYcHdJ/
7JVQo8iQNvxIOiGhQbF7pPVHERIatOF27tkJtj6AkFC9wR5p41m7+L8nJFTv6OtIhIQqERIg
MNyqTy/r9m/lhIQGjU82BMEuipDQoKN/jIKQUCVCAgQICRDgGAkQeDhrJ7g1m5DQIK4jAQKE
BAg83munnOPtTwgJtXt8C2KOkYAE4eFXztoBCZ53RFxHAqIREiBASIAAIQEChAQIEBIgcA1p
/f3qIuc4/BNCQu24RQgQICRAgJAAAUICBAgJECAkQKBESHzYGKpTIiT2SqgOIQEChAQIEBIg
QEiAACEBAoQECBASIBC5RZ8fvnhFlZDQoJSQ7v/ZNkdCQvUSQlp5T1ZCQoMICRAgJEAgNqQQ
riccts+RkFC9+C36fMZu71k7fpICVSl1HYmdEqpCSIAAIQEC6ZvzeMqld2olJFSPPRIgQEiA
ACEBAtGb8+pnVhASGhS7OYenL9bnSEioXtLPIy1OSUhoECEBAgVD4n471KPgMRI3gaMeBc/a
ERLqUfA6EiGhHoQECBASIFA4JM7coQ6FQ2KvhDoQEiBASIAAIQEChAQIEBIgQEiAACEBAoQE
CBASIGAgpLWfywDsMxASOyb4R0iAACEBAnZC4jgJjtkJib0SHCMkQICQAAFbIXGYBKdshcRO
CU4REiBASIAAIQEC5kLihAM8MhcSNznAI5MhcUkJ3pgNiZ0SPMke0qmIlJDYKcGT/CFF1kNI
8MhySLy8gxuWQ+KcA9zI/hmyhIQWZP9U850h8RZDcCFyEw2TXy7NcWdIg8MlgoJdTkLiMi1s
cxbSaKfEPgpmWD9GWrq6xD4KZlg/azd7del6x0Ts8wdysH4daf5c3uBLXuWhNJ8hPZ2CuDU1
IP/OgFlVhDR9X+yz7v7KlB0ZpNI3o/GUk3uCiW25ecnrG6YxsIAAIQEChAQI6K8jAQ3S39kA
NEh/rx3QIEICBAgJEMhzjFTyiqcfSQMGm/KctZNtIxXPiF16VfKMpr3N1t6MCKkqhFRqRoRU
FUIqNSNCqgohlZoRIVWFkErNiJCqQkilZkRIVSGkUjMipKoQUqkZEVJVCKnUjAipKowmIEBI
gAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgECOkGTvfSh8F0XdM9LM
SDgnWJBhNINqtrIZnTZbzWxksxJ+b7Ag14cxC+Yrm9FpJrKtX/OMhN8bTDAc0nB2u2ciDEk3
J0KqRxMhBV2PssO/jo6qYj0k1Z5EMx/pURsd1aSFkKRnP+ydSIEFxkOSHdgbC4ljpNrYDkn0
gkz1uV6EhDmmQxI+OfZIyMr6BVkV4QVZY3OCCYZvEZJ+0qq5c22ctasLowkIEBIgQEiAACEB
AoQECBASIEBIgAAhAQKEBAgQEiBASIAAIQEChAQIEBIgQEiAACEBAoQECBASIEBIgAAhAQKE
BAgQEiBASIAAIQEChAQIEBIgQEiAACEBAq5DCvdfH96TPgx/vb0X//I3y9vaI53vbef+MUMP
38e1ibD0oJnZAfGcbzu3PB5Duucz3G1tmBuQwvm2ExHS+SVed3sJF26v5W6fwuR8ZaAg79vO
oJjxH9/7CsM/vf9RCN1jiN5XBspxv+2E0S/DP71HMnnENLXLyvlEUTXv2878Hmm0Nwrj/Q8h
Qcz5tjN/jNQ9nl4I11d0l7Phg5N5HCNhL+fbzmJI593Vw1m78PiQwe+crwwU5Hvbmb+OdPnv
XEiBkCDletuZv0R0PbswcUGWs3bIwPO2MzxL8HCQM97R3G4R4joSMqll24kvYeKxtawMHK+W
bYeQUFQt2078rdtPj+fub6Rj2wEECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRAgJECA
kAABQgIECAkQICRAgJAAAUICBAgJECAkQICQAAFCAgQICRD4Hy88Ef3C6pRvAAAAAElFTkSu
QmCC" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Properties-of-Ito-integral">Properties of Ito integral<a class="anchor-link" href="#Properties-of-Ito-integral">¶</a></h2><p>Let $\varphi \in L^2_{ad}$ and, for $t \in [0,T]$,</p>
<p>$$
  X_t = \int_0^t \varphi_s dB_s
$$</p>
<p>be the stochastic integral of $\varphi_t$ with respect to Brownian motion $B_t$ up to time $t$. Then $X_t$ has the following properties.</p>
<ul>
<li><em>Adaptivity</em>:  $X_t \in F_t$ for each $t$.</li>
</ul>
<ul>
<li><em>Martingality</em>: $X_t$ is a martingale.</li>
</ul>
<ul>
<li><em>Ito isometry</em>:
$$
E[X_t^2] = E\int_0^t \varphi_s^2 ds\; \leftrightsquigarrow \; E\left[\int_0^t \varphi_s dB_s\right]^2 = \int_0^t E[{\varphi_s^2}] ds.
$$</li>
</ul>
<ul>
<li><em>Quadratic variation</em>:  $[X]_t = \lim_{\parallel{P}\parallel \to 0}\sum_{k=1}^n$ $(X_{t_k} - X_{t_k-1})^2 $ = $\int_0^t \varphi_s^2 ds \leftrightsquigarrow d[X]_t = \varphi_t^2 dt$.</li>
</ul>
<ul>
<li><em>Continuity</em>: $X_t$ is continuous in $t$ a.s.</li>
</ul>
<ul>
<li><p><em>Linearity</em>: Let $\psi_t$ be another adapted process with $E\int_0^T \psi_t^2 dt < \infty$ and $\alpha,\beta \in R$. Then</p>
<p>$$
  \int_0^t (\alpha \varphi_s + \beta \psi_s) dB_s = \alpha \int_0^t \varphi_s dB_s + \beta \int_0^t \psi_s dB_s
  $$</p>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Ito-Processes">Ito Processes<a class="anchor-link" href="#Ito-Processes">¶</a></h1><h4 id="Definition">Definition<a class="anchor-link" href="#Definition">¶</a></h4><p>An adapted process $X_t$ is called an <em>Ito process</em> if it is of the form</p>
<p>$$
  X_t = x + \int_0^t \sigma_s dB_s + \int_0^t b_s ds,
$$</p>
<p>where $\sigma_t$ and $b_s$ are adapted processes. We also write it in differential form as</p>
<p>$$
  d X_t = \sigma_t dB_t + b_t dt, \quad \mbox{with initial condition } X_0 = x.
$$</p>
<p>The coefficient $b_t$ is referred to as the <em>drift</em> (term) and $\sigma_t$ as the <em>diffusion</em> (term) of the Ito process $X_t$.</p>
<h4 id="Lemma">Lemma<a class="anchor-link" href="#Lemma">¶</a></h4><p>The quadratic variation of the Ito process $X_t$ is</p>
<p>$$
  [X]_t = \int_0^t \sigma_s^2 ds \quad \leftrightsquigarrow \quad d[X]_t = \sigma_t^2 dt.
$$</p>
<p>Note that</p>
<ul>
<li>though the quadratic variation of Brownian motion is deterministic (recall $[B]_t = t$ a.s.), in general the quadratic variation of an Ito process is stochastic;</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ito's-formula-for-Brownian-motion">Ito's formula for Brownian motion<a class="anchor-link" href="#Ito's-formula-for-Brownian-motion">¶</a></h2><h4 id="Theorem">Theorem<a class="anchor-link" href="#Theorem">¶</a></h4><p>Let $f(t,x)$ be a function with continuous partial derivatives $f_t$, $f_x$, and $f_{xx}$. Let $W_t = W_0 + B_t$ be a Brownian motion starting at $W_0$ (nonrandom). Then, for every $T \geq 0$,</p>
<p>$$
  f(T,W_T) - f(0,W_0) = \int_0^T f_x(t,W_t) dW_t + \int_0^T \left[f_t(t,W_t) + \frac12 f_{xx}(t,W_t) \right] dt.
$$</p>
<p>Or equivalently in differential form</p>
<p>$$
  df(t,W_t) = f_x(t,W_t) dW_t + \left[ f_t(t,W_t) + \frac12 f_{xx}(t,W_t) \right]dt.
$$</p>
<h4 id="Remark">Remark<a class="anchor-link" href="#Remark">¶</a></h4><p>The idea is that we Taylor expand $f(t,W_t)$ to second order then formly apply the following rule:</p>
<p>$$
 (dB_t)^2 \rightsquigarrow dt, \quad (dt)^2 \rightsquigarrow 0, \quad dB_t dt \rightsquigarrow 0.
$$</p>
<h2 id="Ito's-formula-for-Ito-process">Ito's formula for Ito process<a class="anchor-link" href="#Ito's-formula-for-Ito-process">¶</a></h2><p>Let $f(t,x)$ be a function with continuous partial derivatives $f_t$, $f_x$, and $f_{xx}$. Then for every $T \geq 0$,
\begin{eqnarray*}
  f(T,X_T) - f(0,x) &=& \int_0^T f_t(t,X_t) dt + \int_0^T f_x(t,X_t) dX_t + \frac12 \int_0^T f_{xx}(t,X_t) d[X]_t  \\
  &=& \int_0^T f_x(t,X_t) \sigma_t dB_t + \int_0^T \left[f_t + \frac{\sigma_t^2}2 f_{xx} + b_t f_x \right] dt.
\end{eqnarray*}
Or in differential form
\begin{eqnarray*}
  df(t,X_t) &=& f_t(t,X_t) dt + f_x(t,X_t) dX_t + \frac12 f_{xx}(t,X_t) d[X]_t   \\
  &=& \sigma_t f_x dB_t + \left[ f_t + \frac{\sigma_t^2}2 f_{xx} + b_t f_x \right] dt
\end{eqnarray*}</p>
<h4 id="Remark">Remark<a class="anchor-link" href="#Remark">¶</a></h4><ul>
<li><p>Ito's formula natually decomposes $f(t,X_t)$ into a drift/finite variation part plus a diffusion/martingale part; reminiscent of the Doob decomposition. Processes consist of a finite variation part and a martingale part are also referred to as <em>semimartingales</em>.</p>
</li>
<li><p>Note that the second order differential operator $\frac{\sigma_t^2}2 \partial_x^2 + b_t \partial_x$ in the drift part is the infinitesimal generator of the process $X_t$.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Application-of-Ito's-formula">Application of Ito's formula<a class="anchor-link" href="#Application-of-Ito's-formula">¶</a></h1><p>Using Ito's formula, we could handle with the case of different stochastic integral by decomposing the integral into antiderivative part and a derivative part as : 
$$
\int_a^b f(B_t) dB_t = F(B_t)|_{t=a}^b - \frac12 \int_a^b f'(B_t) dt,
$$
and 
$$
\int_a^b f(t,B_t) dB_t = F(t,B_t)|_{t=a}^b - \int_a^b \left[F_t(t,B_t) + \frac12 f_x(t,B_t)\right] dt,
$$
where $F_x = f$, i.e., $F$ is an antiderivative of $f$ with respect to $x$.</p>
<h3 id="Here-is-two-examples-for-the-application-:">Here is two examples for the application :<a class="anchor-link" href="#Here-is-two-examples-for-the-application-:">¶</a></h3><ul>
<li><p>Evaluate the stochastic integral $\int_0^t B_s dB_s$. <br /> 
  Note that in this case $f(x) = x$. Hence an antidrivative of $f$ is $F(x) = \frac{x^2}2$. <br />
  Apply Ito's formula to $F$ we have</p>
<p>\begin{eqnarray*}
  && d F(B_t) = d\left(\frac{B_t^2}2\right) = B_t dB_t + \frac12 dt \\ 
  &\Longrightarrow& \frac{B_T^2}2 - \frac{B_0^2}2 = \int_0^T B_t dB_t + \frac12 \int_0^T dt \\
  &\Longrightarrow& \int_0^T B_t dB_t = \frac12(B_T^2 - T)
  \end{eqnarray*}
Remember what this is ? Look above on the which rule rules part !</p>
</li>
</ul>
<ul>
<li><p>Evaluate the stochastic integral $\int_0^t se^{B_s} dB_s$. <br />
  Note that in this case $f(t,x) = t e^x$. Hence an antidrivative $F$ of $f$ is $F(t,x) = t e^x$.  Notice that the drift part $b_t = 0$<br />
  Apply Ito's formula to $F$ we have</p>
<p>\begin{eqnarray*}
  && d F(t,B_t) = d\left(t e^{B_t} \right) = e^{B_t} dt + te^{B_t} dB_t + \frac12 te^{B_t} dt \\ 
  &\Longrightarrow& T e^{B_T} = \int_0^T t e^{B_t} dB_t + \int_0^T e^{B_t} \left(1 + \frac t2 \right) dt \\
  &\Longrightarrow& \int_0^T t e^{B_t} dB_t = T e^{B_T} - \int_0^T e^{B_t} \left(1 + \frac t2 \right) dt
  \end{eqnarray*}</p>
</li>
</ul>
<h3 id="Ito's-formula-could-also-be-used-to-solve-SDEs-in-:">Ito's formula could also be used to solve SDEs in :<a class="anchor-link" href="#Ito's-formula-could-also-be-used-to-solve-SDEs-in-:">¶</a></h3><ul>
<li><p><em>Geometric Brownian motion/Black-Scholes model</em></p>
<p>$dX_t = \mu X_t dt + \sigma X_t dB_t$, where $\mu$ and $\sigma$ are constants.</p>
<p>To solve it, we apply Ito's formula to $\log X_t$.</p>
</li>
</ul>
<ul>
<li><p><em>Ornstein-Uhlenbeck process/Vasicek model</em></p>
<p>$dX_t = \lambda(m - X_t) dt + \sigma dB_t$, where $m$, $\lambda$, and $\sigma$ are constants.</p>
<p>To solve it, we apply Ito's formula to $e^{\lambda t} X_t$.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Simulation-of-the-Ornstein-Uhlenbeck-process">Simulation of the Ornstein-Uhlenbeck process<a class="anchor-link" href="#Simulation-of-the-Ornstein-Uhlenbeck-process">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># The code simulates the OU process dX = lambda (m - X) dt + sigma dB</span>
<span class="c1"># by Euler-Maruyama scheme</span>

<span class="c1"># Parameters of the OU process </span>
lambda <span class="o"><-</span> <span class="m">2</span>
m <span class="o"><-</span> <span class="m">0</span>
sigma <span class="o"><-</span> <span class="m">0.2</span>
x0 <span class="o"><-</span> <span class="m">1</span>
Tfin <span class="o"><-</span> <span class="m">1</span>

<span class="c1"># number of paths and number of time steps</span>
NSim <span class="o"><-</span> <span class="m">1e3</span>
NSteps <span class="o"><-</span> <span class="m">100</span>

<span class="c1"># initialize X</span>
X <span class="o"><-</span> <span class="kt">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span>NSim<span class="p">,</span>NSteps<span class="m">+1</span><span class="p">)</span>  
X<span class="p">[,</span><span class="m">1</span><span class="p">]</span> <span class="o"><-</span> x0

<span class="c1"># Euler-Maruyama scheme</span>
dt <span class="o"><-</span> Tfin<span class="o">/</span>NSteps
<span class="kr">for</span> <span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span>NSteps<span class="p">){</span>
  db <span class="o"><-</span> rnorm<span class="p">(</span>NSim<span class="p">)</span>
  db <span class="o"><-</span> db <span class="o">-</span> <span class="kp">mean</span><span class="p">(</span>db<span class="p">)</span>  <span class="c1"># now db has mean 0</span>
  db <span class="o"><-</span> db<span class="o">/</span>sd<span class="p">(</span>db<span class="p">)</span>  <span class="c1"># now db has variance 1</span>

  X<span class="p">[,</span>i<span class="m">+1</span><span class="p">]</span> <span class="o"><-</span> X<span class="p">[,</span>i<span class="p">]</span> <span class="o">+</span> lambda<span class="o">*</span><span class="p">(</span>m <span class="o">-</span> X<span class="p">[,</span>i<span class="p">])</span><span class="o">*</span>dt <span class="o">+</span> sigma<span class="o">*</span><span class="kp">sqrt</span><span class="p">(</span>dt<span class="p">)</span><span class="o">*</span>db
<span class="p">}</span>

par<span class="p">(</span>mfrow<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="c1"># path </span>
n <span class="o"><-</span> <span class="kp">sample</span><span class="p">(</span>NSim<span class="p">,</span><span class="m">1</span><span class="p">)</span>
plot<span class="p">(</span>X<span class="p">[</span>n<span class="p">,],</span>type<span class="o">=</span><span class="s">"l"</span><span class="p">)</span>
lines<span class="p">(</span>X<span class="p">[</span>n<span class="o">+</span><span class="kp">sample</span><span class="p">(</span>NSim<span class="o">-</span>n<span class="p">,</span><span class="m">1</span><span class="p">),],</span>col<span class="o">=</span><span class="s">"purple"</span><span class="p">)</span>

<span class="c1"># histograms at different times</span>
hist<span class="p">(</span>X<span class="p">[,</span><span class="m">2</span><span class="p">],</span>prob<span class="o">=</span><span class="bp">T</span><span class="p">,</span>col<span class="o">=</span><span class="s">'green'</span><span class="p">,</span>breaks<span class="o">=</span><span class="m">20</span><span class="p">,</span>xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">-.5</span><span class="p">,</span><span class="m">1.2</span><span class="p">))</span>
hist<span class="p">(</span>X<span class="p">[,</span>NSteps<span class="m">+1</span><span class="p">],</span>prob<span class="o">=</span><span class="bp">T</span><span class="p">,</span>col<span class="o">=</span><span class="s">'red'</span><span class="p">,</span>breaks<span class="o">=</span><span class="m">20</span><span class="p">,</span>add<span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="c1"># time evolution of mean</span>
t <span class="o"><-</span> <span class="p">(</span><span class="m">0</span><span class="o">:</span>NSteps<span class="p">)</span><span class="o">/</span>NSteps<span class="o">*</span>Tfin
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span><span class="kp">colMeans</span><span class="p">(</span>X<span class="p">),</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'mean'</span><span class="p">)</span>

<span class="c1"># time evolution of variance</span>
t <span class="o"><-</span> <span class="p">(</span><span class="m">0</span><span class="o">:</span>NSteps<span class="p">)</span><span class="o">/</span>NSteps<span class="o">*</span>Tfin
plot<span class="p">(</span><span class="kp">t</span><span class="p">,</span><span class="kp">apply</span><span class="p">(</span>X<span class="p">,</span><span class="m">2</span><span class="p">,</span>FUN<span class="o">=</span>var<span class="p">),</span>type<span class="o">=</span><span class="s">'l'</span><span class="p">,</span>col<span class="o">=</span><span class="s">'blue'</span><span class="p">,</span>ylab<span class="o">=</span><span class="s">'var'</span><span class="p">)</span>
abline<span class="p">(</span>h<span class="o">=</span>sigma<span class="o">^</span><span class="m">2</span><span class="o">/</span><span class="m">2</span><span class="o">/</span>lambda<span class="p">,</span>col<span class="o">=</span><span class="s">'green'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Connection-to-partial-differential-equation">Connection to partial differential equation<a class="anchor-link" href="#Connection-to-partial-differential-equation">¶</a></h2><p>Stochastic differential equation provides a way to numerically solve second order parabolic partial differential equations by Monte Carlo simulation. The key point is a stochastic representation of the solution to partial differential equations which we develop in the following.</p>
<p>Let $X_t$ be the diffusion process driven by</p>
<p>$$
  dX_t = \mu(X_t,t) dt + \sigma(X_t,t) dW_t.
$$</p>
<p>We shall suppress the dependence on $x,t$ of $\mu$ and $\sigma$ for notational simplicity.</p>
<h4 id="Theorem-1">Theorem 1<a class="anchor-link" href="#Theorem-1">¶</a></h4><p>Let $u = u(x,t)$ be the solution to the terminal value problem</p>
<p>\begin{eqnarray*}
  && u_t + \frac{\sigma^2}2 u_{xx} + \mu u_x = 0, \quad t < T, \\
  && u(x,T) = h(x).  
\end{eqnarray*}</p>
<p>Then $u$ has the representation</p>
<p>$$
  u(x,t) = \E_{t,x}\left[h(X_T)\right],
$$</p>
<p>where $\E_{t,x}[\cdot]$ denotes the conditional expectation $\E[\cdot|X_t = x]$. 
This theorem is pretty interesting. Because if means you are heading towards the "you" expected from the current you to a certain degree.</p>
<h4 id="Proof-1">Proof 1<a class="anchor-link" href="#Proof-1">¶</a></h4><p>Based on the theorem we have mentioned above, the proof is relatively direct as : 
$$ 
u(X_T,T) - u(X_t,t) = \int_t^T\sigma(X_x,s)u_x(X_s,s)dW_s
$$
Then we take conditional expectation \E on both sides considering $ u(x,T) = h(x)$, we have 
$$
u(x,t) = E_{t,s}[h(X_T)]
$$</p>
<h3 id="Theorem-2-:-Feynman-Kac-formula">Theorem 2 : Feynman-Kac formula<a class="anchor-link" href="#Theorem-2-:-Feynman-Kac-formula">¶</a></h3><p>However, sometimes the terminal value problem might be more complex as : 
$$
u_t + \frac{\sigma^2}2 u_{xx} + \mu u_x = V(x,t) u, \quad t < T,  \\
u(x,T) = h(x).
$$
Then $u$ has the representation</p>
<p>$$
  u(x,t) = \E_{t,x}\left[e^{-\int_t^T V(X_s,s) ds}h(X_T)\right],
$$</p>
<p>where $\E_{t,x}[\cdot]$ denotes the conditional expectation $\E[\cdot|X_t = x]$. This is the celebrated <em>Feynman-Kac formula</em>. Well, the result is a bit more complext than above, but is we see $e^{-\int_t^T V(X_s,s) ds}$ as a discounted rate as in the economics. Then it has a similar form as the above one.</p>
<h3 id="Proof-2:">Proof 2:<a class="anchor-link" href="#Proof-2:">¶</a></h3><p>Applying Ito's formula to $f(x,t)=u(X_t,t)e^{-\int_0^t V(X_s,s)ds}$ yields</p>
<p>\begin{eqnarray*}
  && d\left[ u(X_t,t)e^{-\int_0^t V(X_s,s)ds} \right] \\
  &=& e^{-\int_0^t V(X_s,s)ds}\left[ u_t(X_t,t) dt - V(X_t,t) u(X_t,t) dt + u_x(X_t,t) dX_t + \frac12 u_{xx}(X_t,t) d[X]_t \right]  \\
  &=& e^{-\int_0^t V(X_s,s)ds}\left[ \left\{ u_t(X_t,t) + \frac{\sigma^2(X_t,t)}2 u_{xx}(X_t,t) + \mu u_x(X_t,t) - V(X_t,t) u(X_t,t) \right\} dt + \sigma(X_t,t) u_x(X_t,t) dB_t \right]  \\
  &=& e^{-\int_0^t V(X_s,s)ds} \sigma(X_t,t) u_x(X_t,t) dB_t
\end{eqnarray*}</p>
<p>since $u$ satisfies the PDE</p>
<p>$$
u_t + \frac{\sigma^2}2 u_{xx} + \mu u_x = V(x,t) u.
$$</p>
<p>In integral form</p>
<p>\begin{eqnarray*}
  u(X_T,T)e^{-\int_0^T V(X_s,s)ds} - u(X_t,t)e^{-\int_0^t V(X_s,s)ds} &=& \int_t^T e^{-\int_0^\tau V(X_s,s)ds} \sigma(X_\tau,\tau) u_x(X_\tau,\tau) dB_\tau
\end{eqnarray*}</p>
<p>therefore, by dividing on both sides the term $e^{-\int_0^t V(X_s,s)ds}$ we have</p>
<p>\begin{eqnarray*}
  u(X_T,T)e^{-\int_t^T V(X_s,s)ds} - u(X_t,t) &=& \int_t^T e^{-\int_t^\tau V(X_s,s)ds} \sigma(X_\tau,\tau) u_x(X_\tau,\tau) dB_\tau.
\end{eqnarray*}
Don't forget to take expected condition before jumping to the conclusion.
This theorem, first put forward by Richard Feynman and Marek Kac, is focused on understanding of the extent to which the spectrun allows one to read back the geometry.</p>
<h2 id="Richard-Phillips-Feynman">Richard Phillips Feynman<a class="anchor-link" href="#Richard-Phillips-Feynman">¶</a></h2><h2><img align="center" src="http://upload.wikimedia.org/wikipedia/en/4/42/Richard_Feynman_Nobel.jpg" width="160" /></h2><p><br />
It is hard to imagine that Feynman's IQ is slightly above the average that could be defined as smart people range. What I see from him is the consistent passion and concentration for the area he loves. This spirit shapes his greatness and uniqueness and inspires me every moment to think different and walk steady.</p>
<h2 id="Marek-Kac">Marek Kac<a class="anchor-link" href="#Marek-Kac">¶</a></h2><h2><img align="center" src="http://upload.wikimedia.org/wikipedia/commons/5/56/Mark_Kac.jpg" width="160" /></h2><h3 id="Theorem-3">Theorem 3<a class="anchor-link" href="#Theorem-3">¶</a></h3><p>Let $u = u(x,t)$ be the solution to the terminal value problem</p>
<p>\begin{eqnarray*}
  && u_t + \frac{\sigma^2}2 u_{xx} + \mu u_x = f(x,t), \quad t < T,  \\
  && u(x,T) = h(x).  
\end{eqnarray*}</p>
<p>Then $u$ has the representation</p>
<p>$$
  u(x,t) = \E_{t,x}\left[h(X_T) - \int_t^T f(X_\tau,\tau) d\tau\right],
$$</p>
<p>where $\E_{t,x}[\cdot]$ denotes the conditional expectation $\E[\cdot|X_t = x]$.</p>
<h3 id="Theorem-4">Theorem 4<a class="anchor-link" href="#Theorem-4">¶</a></h3><p>Let $u = u(x,t)$ be the solution to the terminal value problem</p>
<p>\begin{eqnarray*}
  && u_t + \frac{\sigma^2}2 u_{xx} + \mu u_x = V(x,t) u + f(x,t), \quad t < T,  \\
  && u(x,T) = h(x).  
\end{eqnarray*}</p>
<p>Then $u$ has the representation</p>
<p>$$
  u(x,t) = \E_{t,x}\left[e^{-\int_t^T V(X_s,s)ds}h(X_T) - \int_t^T e^{-\int_t^\tau V(X_s,s)ds} f(X_\tau,\tau) d\tau\right],
$$</p>
<p>where $\E_{t,x}[\cdot] = \E[\cdot|X_t = x]$ is the conditional expectation.</p>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

								</article>
						</div>
					</div>
				</div>
			</section>
	</div>
</div>

				</div>
			</div>

		<!-- Footer Wrapper -->
			<div id="footer-wrapper">
				<!-- Footer -->
					<section id="footer" class="container">
						<div class="row">
							<div class="8u">
								<section>
									<header>
										<h2>Latest articles</h2>
									</header>
									<ul class="dates">
										<li>
											<span class="date">Jan <strong>12</strong></span>
											<h3><a href="welcome.html">Welcome</a></h3>
											<p>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Welcome-to-my-blog">Welcome to my blog<a class="anchor-link" href="#Welcome-to-my-blog">¶</a></h1><p>I would like to share with you how I think and find about the economic world with logic, statistics and to a certain degree, art.</p></p>
										</li>
										<li>
											<span class="date">Jan <strong>01</strong></span>
											<h3><a href="data mining.html">Diabetes Mining</a></h3>
											<p>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Project-Goal">Project Goal<a class="anchor-link" href="#Project-Goal">¶</a></h1><p>Nowadays there are one seventh grown-ups in the United States who have diabetes. However, this number would go larger till 2050 to one third. From the database of diabete of UCL, I hope at least we could learn about diabete based on a data analytics perspective.</p></p>
										</li>
										<li>
											<span class="date">Dec <strong>30</strong></span>
											<h3><a href="micro-market.html">Order Flow Analysis</a></h3>
											<p>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Order-Flow-Analysis-and-Order-Book-Depth">Order Flow Analysis and Order Book Depth<a class="anchor-link" href="#Order-Flow-Analysis-and-Order-Book-Depth">¶</a></h2><p>We remember how in ZI model mentioned previously that order book dynamics are formed based on the randomness of the limit order and the market order. However, we might doubt whether this model setting really matches the practical condition.</p></p>
										</li>
										<li>
											<span class="date">Dec <strong>01</strong></span>
											<h3><a href="microstructure2.html">Stochastic Process</a></h3>
											<p>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Thoughts-on-Stochastic-Process">Thoughts on Stochastic Process<a class="anchor-link" href="#Thoughts-on-Stochastic-Process">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We remember from the basic theory the stochastic process</p></p>
										</li>
									</ul>
								</section>
							</div>
								<div class="4u">
									<section>
										<header>
											<h2>What's this all about?</h2>
										</header>
											<img src="/images/Bernoulli.png" class="image image-full" alt="" />
										<p>
										How to use economics and statistics to change the world? This picture might lead us to a potential answer. At the market, people with transactions willingness come and negotiate.how's price moving, how's the transaction distributed along with the time ? As an oberver, we mightonly access the final pirce and quantity, from which we could infer back to recover the market status.
										</p>
										<footer>
										</footer>
									</section>
								</div>
						</div>
						<div class="row">
							<div class="4u">
								<section>
									<header>
										<h2>Blogroll</h2>
									</header>
									<ul class="divided">
											<li><a href="http://getpelican.com/">Pelican</a></li>
											<li><a href="http://python.org/">Python.org</a></li>
											<li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
											<li><a href="https://github.com">Github</a></li>
									</ul>
								</section>
							</div>
							<div class="4u">
								<section>
									<header>
										<h2>Categories</h2>
									</header>
									<ul class="divided">
											<li><a href="/category/posts.html">Posts</a></li>
											<li><a href="/category/project.html">Project</a></li>
									</ul>
								</section>
							</div>
							<div class="4u">
							
								<section>
									<header>
										<h2>Contact</h2>
									</header>
									<ul class="social">
									</ul>
									<ul class="contact">
											<li>
												<h3>Mail</h3>
												<p><a href="mailto:Victordongy@163.com">Victordongy@163.com</a></p>
											</li>
									</ul>
								</section>
							</div>
						</div>
					</section>
			</div>
		<script src="/theme/js/jquery.min.js"></script>
		<script src="/theme/js/jquery.dropotron.js"></script>
		<script src="/theme/js/config.js"></script>
		<script src="/theme/js/skel.min.js"></script>
		<script src="/theme/js/skel-panels.min.js"></script>
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><link rel="stylesheet" href="/theme/css/ie8.css" /><![endif]-->
	</body>
</html>